<!DOCTYPE html>
<head>
<script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.14/angular.min.js"></script>
<script src="//rawgit.com/angular-ui/angular-google-maps/2.1.5/dist/angular-google-maps.js"></script>
<!--<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=geometry"></script>-->
<script src="https://maps.googleapis.com/maps/api/js?libraries=geometry"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/3.5.0/lodash.min.js"></script>
<script src="https://code.angularjs.org/1.4.5/angular-route.js"></script> 
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="javascripts/app.js"></script>

<link rel="stylesheet" href="stylesheets/styles.css">
<link rel="stylesheet" href="stylesheets/css/bootstrap.css">
</head>

<body>
	<div ng-app="myapp" ng-controller="myCtrl">
	<div id="container">
		<div id="header">
			<div id="headerLeft">
				<div>
					<h1 style="margin: 10px;">
						<img src={{data[0].athlete.profile_medium}} alt="" height="42" width="42">
						{{data[0].athlete.firstname}}
						{{data[0].athlete.lastname}}
					</h1>
				</div>
				<div>
					<b>{{data[0].athlete.city}}</b>
					<b>{{data[0].athlete.state}}</b>
					<b>{{data[0].athlete.country}}</b>
					
				</div>	
			</div>
			<div id="headerRight">
				<div>
					<b>Followers:{{data[0].athlete.follower_count}}</b>
					<b>Friends:{{data[0].athlete.friend_count}}</b>
				</div>
				<div>
					<b>FTP:{{data[0].athlete.ftp}}</b>
					<b>Weight:{{data[0].athlete.weight}}</b>					
				</div>
				
			</div>
		</div>
		<div id="navigator"></div>
		<div id="main">			
			<div id="mainLeft">
				<h2>Activities</h2>
				<div >
					<table>
						<tr>
							<td><b>Date</b></td>
							<td><b>Distance</b></td>
							<td><b>Elevation</b></td>
							<td><b>Kudos</b></td>
							<td><b>Achievements</b></td>
							<td><b>Avg. speed</b></td>
						</tr>			
						<tr id="activity" ng-repeat-start="activity in data[1].activity" ng-click="selActivity(activity)" ng-hide="isSelected(!activity)" >
							<td>{{activity.start_date | date}}</td>
							<td>{{activity.distance/1000 | number:1}}km</td>
							<td>{{activity.total_elevation_gain}}m</td>
							<td>{{activity.kudos_count}}</td>
							<td>{{activity.achievement_count}}</td>
							<td>{{activity.average_speed/1000*3600 | number:1}}kmh</td>
						</tr>
					
						<tr ng-repeat-end ng-if="isSelected(activity)">
						
							<td>
							{{activity.name}}

						    <ui-gmap-google-map id="map"
		                       center="{latitude: activity.start_latlng[0], longitude: activity.start_latlng[1]}"
		                       pan="map.pan"
		                       zoom="map.zoom"
		                       draggable="true"
		                       refresh="map.refresh"
		                       options="map.options"
		                       events="map.events"
		                       bounds="map.bounds">

		                     

						        <!--<ui-gmap-map-control template="polyButton.tpl.html" position="top-right" index="1" controller="mapWidgetCtrl">
						        </ui-gmap-map-control>

						        <ui-gmap-map-control template="clear.tpl.html" position="top-right" index="1" controller="mapWidgetCtrl">
						        </ui-gmap-map-control>-->

						        <!--<ui-gmap-polylines models="activity.map.summary_polyline | gps" path="'path'" stroke="'stroke'" visible="'visible'"
						                          geodesic="'geodesic'" editable="'editable'" draggable="'draggable'" static="true" >
						        </ui-gmap-polylines>-->

						        <ui-gmap-polyline ng-repeat="p in data[1].activity.map.summary_polyline.path" path="p.path" stroke="p.stroke" visible="p.visible"
						        geodesic="p.geodesic" editable="p.editable" draggable="p.draggable" static="true">
						        </ui-gmap-polyline> 
						    </td>
						    </ui-gmap-google-map>
						    						   						    
					    	<td colspan="5" style="vertical-align:top">
						    	<table>
						    		<tr>
						    			<td><b>Avg. Cadence</b></td> 
			    						<td><b>Avg. HR</b></td>
			    						<td><b>Max. HR</b> </td>
			    						<td><b>Avg. Power</b></td>
			    						<td><b>Max. Speed</b></td>
			    					</tr>
						    		<tr>
						    			<td>{{activity.average_cadence}}rpm</td> 
			    						<td>{{activity.average_heartrate}}bpm</td>
			    						<td>{{activity.max_heartrate}}bpm</td> 
			    						<td>{{activity.average_watts}}w</td> 
			    						<td>{{activity.max_speed}}kmh</td> 
						    		</tr>
						    	</table>
							</td>
						</tr>		
					</table>
				</div>	    				   
			</div>

			<div id="mainRight">
				<h2>Totals</h2>
				<div>
					<table style="float: left">
						<tr>
							<td><b>This year</b></td>
						</tr>
						<tr>
							<td>Rides</td><td>{{data[2].stats.ytd_ride_totals.count}}</td>
						</tr>
						<tr>
							<td>Distance</td><td>{{data[2].stats.ytd_ride_totals.distance/1000 | number:1}}km</td>
						</tr>
						<tr>
							<td>Time</td><td>{{scoper(data[2].stats.ytd_ride_totals.moving_time)}}h</td>
						</tr>
						<tr>
							<td>Elevation</td><td>{{data[2].stats.ytd_ride_totals.elevation_gain}}m</td>
						</tr>				
					</table>
					<table style="float: left; margin: 0 0 0 30px">
						<tr>
							<td><b>Last 4 weeks</b></td>
						</tr>
						<tr>
							<td>Rides</td><td>{{data[2].stats.recent_ride_totals.count}}</td>
						</tr>
						<tr>
							<td>Distance</td><td>{{data[2].stats.recent_ride_totals.distance/1000 | number:1}}km</td>
						</tr>
						<tr>
							<td>Time</td><td>{{scoper(data[2].stats.recent_ride_totals.moving_time)}}h</td>
						</tr>
						<tr>
							<td>Elevation</td><td>{{data[2].stats.recent_ride_totals.elevation_gain}}m</td>
						</tr>					
					</table>
				</div>
				<br>

				<div style="margin: 150px 0 0 0">
					<table style="float: left">
						<tr>
							<td><b>All time</b></td>
						</tr>
						<tr>
							<td>Rides</td><td>{{data[2].stats.all_ride_totals.count}}</td>
						</tr>
						<tr>
							<td>Distance</td><td>{{data[2].stats.all_ride_totals.distance/1000 | number:1}}km</td>
						</tr>
						<tr>
							<td>Time</td><td>{{scoper(data[2].stats.all_ride_totals.moving_time)}}h</td>
						</tr>
						<tr>
							<td>Elevation</td><td>{{data[2].stats.all_ride_totals.elevation_gain}}m</td>
						</tr>				
					</table>
					<table style="float: left; margin: 0 0 0 35px">
						<tr>
							<td><b>Bikes</b></td>
						</tr>
						<tr ng-repeat="bike in data[0].athlete.bikes">
							<td>{{bike.name}}</td>
							<td>{{bike.distance/1000 | number:1}}km</td>
						</tr>
					</table>				
				</div>

				<div style="clear: both">
					
					<h2>Clubs</h2>
					<div ng-repeat="club in data[0].athlete.clubs">			
						<ul id="clubs">
							<li><img src={{club.profile_medium}} alt="" height="60" width="60">{{club.name}}</li>
						</ul>				
					</div>
				</div>				
			</div>
	</div>
</body>

</html>
